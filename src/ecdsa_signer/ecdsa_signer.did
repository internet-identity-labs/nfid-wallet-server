type KeyPair = record {
    public_key : text;
    private_key_encrypted : text
};

type KeyPairResponse = record {
    key_pair : opt KeyPair;
    princ : text
};

service : {
    add_kp : (KeyPair) -> ();
    get_kp : () -> (KeyPairResponse);
    get_principal : (opt text) -> (text, opt text) query;
    get_trusted_origins : () -> (vec text);
    get_public_key : (text) -> (opt text) query;
}